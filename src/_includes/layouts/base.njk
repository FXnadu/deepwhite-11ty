<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% set assetsConfig = assets or {} %}
    {% set pageTitle = title or metadata.title or '[DEEPWHITE]' %}
    <title>{{ pageTitle }} - [DEEPWHITE]</title>
    <link rel="icon" href="{{ '/img/deepwhitelogo.png' | url }}" type="image/png" sizes="192x192">
    {% if assetsConfig.criticalCssInline %}
    <style>{{ assetsConfig.criticalCssInline | safe }}</style>
    {% endif %}
    {% if assetsConfig.mainCssHref %}
    <link rel="stylesheet" href="{{ assetsConfig.mainCssHref | url }}">
    {% endif %}
    {% for cssFile in extraCss | toArray %}
    {% set versionSuffix = assetsConfig.assetVersionSuffix | default("") %}
    <link rel="stylesheet" href="{{ (cssFile + versionSuffix) | url }}">
    {% endfor %}
    {%- set pageTags = tags | default([]) | toArray -%}
    {%- set entryAnimation = entryAnimation | default(false) -%}
    {%- set hasSpecialArchiveTag = 'special-archive' in pageTags -%}
    {%- set shouldShowEntryAnimation = entryAnimation or hasSpecialArchiveTag -%}
    {%- if shouldShowEntryAnimation -%}
    {% set versionSuffix = assetsConfig.assetVersionSuffix | default("") %}
    <link rel="stylesheet" href="{{ ('/css/special-archive-entry.css' + versionSuffix) | url }}">
    {%- endif -%}
</head>
<body data-show-floating="{{ (showFloatingActions | default(false)) and 'true' or 'false' }}"{% if shouldShowEntryAnimation %} class="is-loading"{% endif %}>
    {%- if shouldShowEntryAnimation -%}
    <!-- 粒子画布 -->
    <canvas id="particle-layer"></canvas>
    <!-- 内容包裹层 -->
    <div id="main-wrapper">
    {%- endif -%}
    <div class="container">
        <header class="site-header">
            {% set isSpecialArchivePage = isSpecialArchivePage | default(false) %}
            {% set isHomePage = (page.url === '/' or page.url === '/index.html') %}
            {% if isSpecialArchivePage %}
                {% set brandTarget = '/' %}
                {% set brandLabel = '返回首页' %}
                {% set brandText = 'DEEPWHITE' %}
            {% elif isHomePage %}
                {% set brandTarget = '/special-archive/' %}
                {% set brandLabel = '前往炫技特别归档' %}
                {% set brandText = 'Deepwhite' %}
            {% else %}
                {% set brandTarget = '/' %}
                {% set brandLabel = '返回首页' %}
                {% set brandText = 'Deepwhite' %}
            {% endif %}
            <div class="site-branding">
                <h1 class="site-title{% if isSpecialArchivePage %} site-title-uppercase{% endif %}">
                    <a href="{{ brandTarget | url }}" aria-label="{{ brandLabel }}">{{ brandText }}</a>
                </h1>
            </div>
            <div class="site-controls">
                <nav class="site-nav">
                    <a href="{{ '/' | url }}">首页</a>
                    <a href="{{ '/archive/' | url }}">归档</a> 
                    <a href="{{ '/about/' | url }}">关于我</a>
                </nav>
            </div>
        </header>

        <main>
            {{ content | safe }}
        </main>

        <footer class="site-footer">
            <p>&copy; 2025 [DEEPWHITE]. <br>完美不在于无以复加，而在于无可删减。</p>
        </footer>
    </div>

        {% if showFloatingActions %}
        <div class="floating-actions" id="floating-actions">
            <a href="javascript:history.back()" class="action-btn" aria-label="返回上一页">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
            </a>
            <a href="#" class="action-btn" id="action-btn-top" aria-label="返回顶部">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="19 12 12 5 5 12"></polyline></svg>
            </a>
        </div>
        {% endif %}
    {%- if shouldShowEntryAnimation -%}
    </div>
    <!-- 结束内容包裹层 -->
    {%- endif -%}
</body>
{% set requestedIslands = islands | toArray %}
{% if requestedIslands | length %}
    {% for islandName in requestedIslands %}
        {% set islandRegistry = assetsConfig.islands or {} %}
        {% set island = islandRegistry[islandName] %}
        {% if island %}
<script {% if island.module %}type="module"{% endif %} src="{{ island.src | url }}" defer></script>
        {% endif %}
    {% endfor %}
{% endif %}
{% if 'site' not in requestedIslands %}
    {% set islandRegistry = assetsConfig.islands or {} %}
    {% set siteIsland = islandRegistry['site'] %}
    {% if siteIsland %}
<script {% if siteIsland.module %}type="module"{% endif %} src="{{ siteIsland.src | url }}" defer></script>
    {% endif %}
{% endif %}
{%- if shouldShowEntryAnimation -%}
{% set versionSuffix = assetsConfig.assetVersionSuffix | default("") %}
<script src="{{ ('/js/special-archive-entry.js' + versionSuffix) | url }}"></script>
{%- endif -%}
</html>